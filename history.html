<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Cotion - Upload History</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<body>
    <div class="header">
        <h1>Upload History</h1>
    </div>
    <div class="content">
        <?php
            // Create connection
            $conn = new mysqli($servername, $username, $password, $dbname);

            // Check connection
            if ($conn->connect_error) {
                die("Connection failed: " . $conn->connect_error);
            }

            // Fetch data from table
            $sql = "SELECT upload_date, file_name, feedback, score FROM uploads WHERE user_id = ?";
            if ($stmt = $conn->prepare($sql)) {
                // Bind the user id from the session or from a cookie
                $stmt->bind_param("i", $_SESSION['user_id']);

                // Execute the statement
                $stmt->execute();

                // Bind the result variables
                $stmt->bind_result($upload_date, $file_name, $feedback, $score);

                // Fetch the values
                while ($stmt->fetch()) {
                    echo "<div class='upload-history'>";
                    echo "<h2>Uploaded File: " . htmlspecialchars($file_name) . "</h2>";
                    echo "<p>Upload Date: " . htmlspecialchars($upload_date) . "</p>";
                    echo "<p>Feedback: " . htmlspecialchars($feedback) . "</p>";
                    echo "<p>Score: " . htmlspecialchars($score) . "</p>";
                    echo "</div>";
                }

                // Close the statement
                $stmt->close();
            }

            // Close connection
            $conn->close();
        ?>
    </div>
</body>
</html>
